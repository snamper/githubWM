define(function(require,exports,module){var g=require("http://a.myhd.wumeiwang.com/hdgw/model/domains/dist/domains.js");var d=require("http://a.myhd.wumeiwang.com/hdgw/model/lib/jquery/seajs-jquery-1.8.3.min.js"),c=require("http://a.myhd.wumeiwang.com/hdgw/model/lib/juicer/seajs-juicer-min.js");var b=function(h){return h instanceof d?h:d(h)};var f=function(){var i=d("body"),h=i[0];return h.scrollTop||document.documentElement.scrollTop||window.pageYOffset||0};var e=function(j){var i=d(window),h=d("body");i.on("resize.downList",function(){h.find(".input_downlist:visible").each(function(){var m=d(this),l=m.data("createData"),k=l.input.offset();if(m.css("position")==="fixed"){k.top=k.top-f()+l.input.outerHeight()}else{k.top=k.top+l.input.outerHeight()}m.css({top:k.top,left:k.left})})});e=function(q){var o=d("body"),l=this,k,p,m,n;if(d.browser.msie&&d.browser.version){this.$downBox[0].onselectstart=function(){return false}}this.$input.on("keydown",function(u){if(u.keyCode==38||u.keyCode==40){var t=d(this),s=o.find("#"+t.attr("for")),r;l.showDownList();n=s.find("."+q.chkedClass);if(!n.length){n=s.find("."+q.itemClass+":eq(0)");n.addClass(q.chkedClass)}else{n.removeClass(q.chkedClass);r=u.keyCode==40?n.next():n.prev();if(r.length){r.addClass(q.chkedClass)}else{s.find("."+q.itemClass+(u.keyCode==40?":first":":last")).addClass(q.chkedClass)}}n=s.find("."+q.chkedClass);k=n.position();m=n.outerHeight();p=s.outerHeight();if(k.top<0){s.scrollTop(s.scrollTop()+k.top)}if(k.top+m>p){s.scrollTop(s.scrollTop()+(k.top+m-p))}typeof q.updownCallback==="function"&&q.updownCallback.call(q.input,s.find("."+q.chkedClass));return false}if(u.keyCode==13){l.hideDownList()}})};e.call(this,j)};var a=function(l){var p=this;var i=d.extend({input:null,chkedClass:"curr",itemClass:"input_downitem",updownCallback:function(q){this.val(q.attr("data_text"))}},l);var k=d("body"),n,m,j,o,h=c(i.listItemModel||'<ul>{@each list as item}<li class="'+i.itemClass+'" data_text="${item.txt}">${item.txt}</li>{@/each}</ul>');if(!i.input){throw"parameter input wminputdown created can not be empty！";return false}i.input=b(i.input);if(!i.input.length){throw"wminputdown Element not found！";return false}i.input.attr("autocomplete","off");o=i.input.offset();n=i.input.attr("id");if(!n){n="down_list_input"+parseInt(Math.random()*999999);i.input.attr("id",n)}j=n+"_downbox";i.input.attr("for",j);this.$downBox=d('<div id="'+j+'" class="input_downlist" for="'+n+'"></div>');if(i.position==="fixed"){o.top=o.top-f()+i.input.outerHeight()}else{o.top=o.top+i.input.outerHeight()}this.$downBox.css({width:i.width||(i.input.outerWidth()-2),position:i.position||"absolute","z-index":i.zIndex,top:o.top,left:o.left,display:"none"});this.$downBox.data("instantiation",this);this.$downBox.data("createData",{input:i.input});this.$input=i.input;k.append(this.$downBox);e.call(this,i);this.html=function(q){if(q){p.$downBox.empty().append(q)}else{return p.$downBox.html()}d(window).resize();return p};this.append=function(q,r){p.$downBox.append(h.render(q));d(window).resize();typeof r==="function"&&r.call(p,i);return p};this.empty=function(q){p.$downBox.empty();d(window).resize();typeof q==="function"&&q.call(p,i);return p};this.setModel=function(q){if(typeof q==="string"){h=c(q)}return p};this.showDownList=function(q){p.$downBox.css("display","block");d(window).resize();return p};this.hideDownList=function(){p.$downBox.css("display","none");return p};typeof i.callback==="function"&&i.callback.call(this)};exports.Create=function(h){return new a(h)}});